{"hash":"782414107f461c86c0093807ec9a7009f522142f","data":{"article":{"id":"2e11ee70106b710eed384e31d4fd9c12","title":"SignalR Transports Explained","date":"August 17, 2015","categories":["Development - ASP.NET"],"permalink":"signalr-transports-explained","content":"<p>When I sit down to talk to people about SignalR, a common discussion we have is around transports and what the difference between them are.  While SignalR gives you the flexibility to choose your own transport, it is often a better bet to simply allow the library to choose for you.</p>\n<h2 id=\"how-does-signalr-determine-which-transport-to-use\"><a href=\"#how-does-signalr-determine-which-transport-to-use\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>How does SignalR determine which transport to use?</h2>\n<p>There are two pieces of the puzzle that need to be evaluated before a transport is chosen.  The <strong>client</strong> and the <strong>server</strong>.  Keep in mind, a SignalR client can be something other than JavaScript.. and the server can be something not running on IIS.  </p>\n<p>If you <a href=\"http://www.asp.net/signalr/overview/getting-started/introduction-to-signalr#transports\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">head over to SignalR documentation</a>, they provide a really great overview on how SignalR chooses a transport.</p>\n<p>A simple way to explain the process is this:  </p>\n<ol>\n<li>If you're using legacy browser (IE8 or later.. <em>cough</em>)... use Long Polling.  </li>\n<li>Do you need JSONP support?  Yes?  Long polling, for you.</li>\n<li>\n<p>Okay okay.  Let's try Websockets!  This works well IF:</p>\n<ul>\n<li>You're not doing JSONP</li>\n<li>You're not going cross-domain</li>\n<li>You ARE going cross-domain AND client supports CORS (Cross-Origin Resource Sharing).</li>\n<li>Client supports WebSockets <strong>(IE10+, Chrome, Firefox, Safari, etc)</strong></li>\n<li>Server supports WebSockets <strong>(IIS 8.0+ or self-hosted SignalR)</strong></li>\n</ul>\n</li>\n<li>No WebSockets?  Sorry.  Give Server Sent Events a try (most likely on non-IE browsers).</li>\n<li>No SSE?  Try Forever Frame (IE browsers).</li>\n<li>No FF? MORE LONG POLLING!</li>\n</ol>\n<h2 id=\"what-are-the-pros-and-cons-of-each-transport-type\"><a href=\"#what-are-the-pros-and-cons-of-each-transport-type\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>What are the pros and cons of each transport type?</h2>\n<p>Excellent question!  Let's walk through the list worse-case to best-case.</p>\n<h3 id=\"long-polling\"><a href=\"#long-polling\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Long Polling</h3>\n<p>Long polling is a game of hurry up and wait.  During this process, you are opening up a pipe (AJAX call) for the server to use for possible future communication.  Anytime the server needs to send a message, the existing connection can be used.</p>\n<p>However, when a connection is used, the connection is closed.  In order to continue communicating with the server, a client will need to reestablish the connection.  In a best case scenario, the server is continuously sending data, so a connection is always reestablishing.  Worse case, the connection stands open for up to two minutes (default timeout on most browsers).  The process of continuously opening and closing connections can be a bit of a strain on the server.</p>\n<p>Long polling works well on old browsers, including some browsers which should have died ten years ago.  This is the final fallback position if no other acceptable transport can be used.</p>\n<h3 id=\"forever-frame\"><a href=\"#forever-frame\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Forever Frame</h3>\n<p>Warning: Forever Frame (FF) is Internet Explorer only, but it's really interesting how this process works.  When a connection is established with FF, a hidden Iframe is created on the page.  However, the page loaded into the Iframe is special.  The connection will never closed.</p>\n<p>Since the connection remains open forever, the server can use it to continuously send new script.  These scripts are loaded and executed on the parent page.  </p>\n<p>Any client to server communication needs to be done the traditional way, via AJAX calls.</p>\n<h3 id=\"server-sent-events\"><a href=\"#server-sent-events\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Server Sent Events</h3>\n<p>Some technologies stand the test of time, and Server Sent Events (SSE) is a great example.  SSE is a server to client communication protocol developed in the Netscape days.  It creates an object called an EventSource, which is a pipe from the server to the client.  Anytime the server needs to send data, the EventSource pipe can be used.  </p>\n<p>SSE is supported on all browsers, except Internet Explorer (sorry, but you have Forever Frame).  Just as Forever Frame, if the client needs to communicate back with the server, a traditional AJAX call will need to be made.</p>\n<h3 id=\"websockets\"><a href=\"#websockets\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>WebSockets</h3>\n<p>Holy.  Grail.  Seriously.  There is nothing better than WebSockets.  When a WebSocket connection is made, there is a one-to-one connection between the client and server.  Both are capable of communicating on the existing pipe.  </p>\n<p>Of course, you are technically limited by the browser and server being used for a connection.  Internet Explorer 9 and older need not apply (IE10+ are the only versions with WebSockets support).  Firefox, Chrome, and Safari generally have no problems.</p>\n<p>For .NET folks deploying to IIS, you better be sure you are using IIS version 8 (or greater).  IIS7 did not have support for WebSockets.</p>\n<h2 id=\"pulling-it-all-together\"><a href=\"#pulling-it-all-together\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>Pulling It All Together</h2>\n<p>As you look at the various transports available, you should start to appreciate what SignalR is doing for you underneath the scenes.  What would happen if you had to implement all these different scenarios yourself?</p>\n"}},"context":{}}